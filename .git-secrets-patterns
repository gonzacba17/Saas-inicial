# Git-secrets patterns for SaaS Cafeter√≠as
# Custom patterns to detect secrets before commit

# Generic patterns
[A-Za-z0-9_]*[Pp][Aa][Ss][Ss][Ww][Oo][Rr][Dd][A-Za-z0-9_]*\s*=\s*['\"][^'\"]{8,}['\"]
[A-Za-z0-9_]*[Ss][Ee][Cc][Rr][Ee][Tt][A-Za-z0-9_]*\s*=\s*['\"][^'\"]{8,}['\"]
[A-Za-z0-9_]*[Aa][Pp][Ii][_-]?[Kk][Ee][Yy][A-Za-z0-9_]*\s*=\s*['\"][^'\"]{8,}['\"]
[A-Za-z0-9_]*[Tt][Oo][Kk][Ee][Nn][A-Za-z0-9_]*\s*=\s*['\"][^'\"]{8,}['\"]

# AWS Keys
AKIA[0-9A-Z]{16}
[Aa](WS|ws)?.{0,20}['\"][0-9a-zA-Z/+]{40}['\"]

# Database URLs
postgres://[a-zA-Z0-9]+:[a-zA-Z0-9]+@[a-zA-Z0-9.-]+:[0-9]+/[a-zA-Z0-9_]+
mongodb(\+srv)?://[a-zA-Z0-9]+:[a-zA-Z0-9]+@[a-zA-Z0-9.-]+
mysql://[a-zA-Z0-9]+:[a-zA-Z0-9]+@[a-zA-Z0-9.-]+

# Redis URLs with passwords
redis://:[^@\s]+@[a-zA-Z0-9.-]+

# JWT Secrets (long base64-like strings)
['\"]eyJ[a-zA-Z0-9_-]{30,}['\"]

# OpenAI API Keys
sk-[a-zA-Z0-9]{48}
sk-proj-[a-zA-Z0-9]{48}

# MercadoPago Tokens
APP_USR-[0-9]{16}-[0-9]{6}-[a-z0-9]{32}
TEST-[0-9]{16}-[0-9]{6}-[a-z0-9]{32}

# Private Keys
-----BEGIN (RSA |DSA |EC )?PRIVATE KEY-----
-----BEGIN OPENSSH PRIVATE KEY-----

# Generic long secrets (base64/hex patterns)
['\"][a-zA-Z0-9/+_-]{64,}['\"]

# Environment files that should never be committed
\.env\.production(?!\.example)
\.env\.local(?!\.example)
\.env\.staging(?!\.example)
docker-compose\.secrets\.yml

# Specific to this project
MERCADOPAGO_ACCESS_TOKEN\s*=\s*(?!APP_USR_YOUR|TEST-YOUR|\s*$)['\"]?[A-Za-z0-9_-]+
OPENAI_API_KEY\s*=\s*(?!sk-your|sk-proj-your|\s*$)['\"]?sk-[a-zA-Z0-9]{20,}
SECRET_KEY\s*=\s*(?!CHANGE_THIS|\s*$|your-secret)['\"]?[A-Za-z0-9_-]{32,}
POSTGRES_PASSWORD\s*=\s*(?!CHANGE_TO|password|\s*$)['\"]?[A-Za-z0-9@#$%^&*()_+-=]{12,}
REDIS_PASSWORD\s*=\s*(?!CHANGE_TO|password|\s*$)['\"]?[A-Za-z0-9@#$%^&*()_+-=]{8,}
